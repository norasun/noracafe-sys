var _callbacks=[],_promises=[],Dispatcher=function(){};Dispatcher.prototype=$.extend(Dispatcher.prototype,{register:function(t){return _callback.push(t),_callback.length-1},dispatch:function(t){var e=[],c=[];_promises=_callbacks.map(function(t,c){return new Promise(function(t,r){e[c]=t,r[c]=r})}),_callbacks.forEach(function(r,n){Promise.resolve(r(t)).then(function(){e[n](t)},function(){c[n](new Error("Dispatcher报错!"))})}),_promises=[]}});var AppDispatcher=$.extend(Dispatcher.prototype,{handleViewAction:function(t){this.dispatch({source:"VIEW_ACTION",action:t})}});alert(1);